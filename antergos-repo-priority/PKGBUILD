# Maintainer: Antergos Developers <dev@antergos.com>

pkgname=antergos-repo-priority
pkgver=1.0.4rc2
pkgrel=1
pkgdesc="Automatically adjusts the priority of the antergos repo in pacman.conf as needed."
arch=('any')
depends=('pacman>=5.0' 'python-termcolor' 'libnotify' 'gettext')
groups=('antergos-base')
url="https://antergos.com/"
license=('GPL')
install="${pkgname}.install"
source=("${pkgname}-${pkgver}.zip::https://github.com/Antergos/${pkgname}/archive/${pkgver}.zip")
md5sums=('bafb830f1bb154db80f42d7f3af7ddfa')

package() {
	mkdir -p "${pkgdir}/usr/share/{libalpm,antergos,locale}"
	mkdir -p "${pkgdir}/usr/share/libalpm/hooks"
	mkdir -p "${pkgdir}/usr/bin"

	cd "${srcdir}/${pkgname}-${pkgver}"

	install -m777 "99-${pkgname}.hook" "${pkgdir}/usr/share/libalpm/hooks"
	install -m777 "${pkgname}.py" "${pkgdir}/usr/bin"
	install -m777 'antergos-notify.sh' "${pkgdir}/usr/bin"
	install -m644 'logo-square32.png' "${pkgdir}/usr/share/antergos"
	
	for fpath in po/*; do
		if [[ -f "${fpath}" ]] && [[ "${fpath}" != 'po/ANTERGOS_NOTIFY.pot' ]]; then
			STRING_PO=`echo ${fpath#*/}`
			STRING=`echo ${STRING_PO%.po}`
			mkdir -p "${pkgdir}/usr/share/locale/${STRING}/LC_MESSAGES"
			msgfmt "${fpath}" -o "${pkgdir}/usr/share/locale/${STRING}/LC_MESSAGES/ANTERGOS_NOTIFY.mo"
			echo "${STRING} installed..."
		fi
	done
}

# -*- mode: bash;-*-
